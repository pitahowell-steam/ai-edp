<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Real AI Engineer: Apple vs Tomato</title>
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f4f8; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); max-width: 900px; width: 100%; }
        .status-bar { background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 20px; text-align: center; font-weight: bold; border: 1px solid #ffeeba; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .zone { background: #fafafa; border: 2px solid #eaedf0; padding: 20px; border-radius: 12px; }
        img { width: 100%; height: 200px; object-fit: contain; background: #eee; margin: 10px 0; border-radius: 8px; border: 1px solid #ddd; }
        input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; margin: 8px 0; cursor: pointer; border: none; border-radius: 6px; font-weight: bold; transition: 0.2s; }
        .btn-apple { background: #43a047; color: white; }
        .btn-tomato { background: #e53935; color: white; }
        .btn-train { background: #1e88e5; color: white; font-size: 1.1em; }
        .btn-train:disabled { background: #ccc; cursor: not-allowed; }
        #result-text { font-size: 1.8em; text-align: center; margin-top: 15px; color: #333; }
        .loader { color: #856404; }
    </style>
</head>
<body>

<div class="container">
    <h1>üçé Machine Learning Lab: EDP üçÖ</h1>
    <div id="status" class="status-bar loader">Step 1: Loading Neural Network (MobileNet)...</div>

    <div class="grid">
        <div class="zone">
            <h2>Phase 1: Train (Create)</h2>
            <p>Paste an image URL to teach the AI:</p>
            <input type="text" id="img-url" placeholder="Paste Image Link Here...">
            <img id="preview" src="https://placehold.co/400x200?text=Image+Preview" crossorigin="anonymous">
            
            <button class="btn-apple" onclick="addSample('Apple')">Add as APPLE</button>
            <button class="btn-tomato" onclick="addSample('Tomato')">Add as TOMATO</button>
            
            <p>Training Samples: <b id="amount">0</b></p>
            <button class="btn-train" id="train-btn" onclick="trainModel()" disabled>Run Training Engine</button>
        </div>

        <div class="zone">
            <h2>Phase 2: Test (Evaluate)</h2>
            <p>Paste a NEW URL to test the model:</p>
            <input type="text" id="test-url" placeholder="Paste Test Link Here...">
            <img id="test-preview" src="https://placehold.co/400x200?text=Test+Preview" crossorigin="anonymous">
            
            <button onclick="predict()" style="background:#546e7a; color:white;">Does the AI know what this is?</button>
            <div id="result-text">---</div>
        </div>
    </div>
</div>

<script>
    let featureExtractor;
    let classifier;
    let count = 0;

    // Load MobileNet - a pre-trained "brain" that already understands shapes
    featureExtractor = ml5.featureExtractor('MobileNet', () => {
        document.getElementById('status').innerText = "‚úÖ AI Ready! Start adding images.";
        document.getElementById('status').style.background = "#d4edda";
        document.getElementById('status').style.color = "#155724";
        classifier = featureExtractor.classification();
    });

    // Update image previews automatically when URLs are pasted
    document.getElementById('img-url').oninput = (e) => document.getElementById('preview').src = e.target.value;
    document.getElementById('test-url').oninput = (e) => document.getElementById('test-preview').src = e.target.value;

    function addSample(label) {
        const img = document.getElementById('preview');
        classifier.addImage(img, label);
        count++;
        document.getElementById('amount').innerText = count;
        if(count > 3) document.getElementById('train-btn').disabled = false;
    }

    function trainModel() {
        document.getElementById('status').innerText = "üß† Training... The AI is finding patterns in the pixels!";
        document.getElementById('status').style.background = "#cce5ff";
        
        classifier.train((lossValue) => {
            if (!lossValue) {
                document.getElementById('status').innerText = "‚úÖ Training Complete! Try the Test phase.";
                document.getElementById('status').style.background = "#d4edda";
            }
        });
    }

    function predict() {
        const testImg = document.getElementById('test-preview');
        classifier.classify(testImg, (err, results) => {
            if (err) {
                document.getElementById('result-text').innerText = "Error (Try a Wikipedia Link)";
            } else {
                let label = results[0].label;
                let conf = Math.round(results[0].confidence * 100);
                document.getElementById('result-text').innerText = `${label} (${conf}%)`;
            }
        });
    }
</script>

</body>
</html>
